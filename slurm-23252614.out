[NbConvertApp] Converting notebook notebooks/hyperparameter_choices/num_rounds.ipynb to notebook
Traceback (most recent call last):
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/bin/jupyter-nbconvert", line 8, in <module>
    sys.exit(main())
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/jupyter_core/application.py", line 283, in launch_instance
    super().launch_instance(argv=argv, **kwargs)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/traitlets/config/application.py", line 1075, in launch_instance
    app.start()
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/nbconvertapp.py", line 420, in start
    self.convert_notebooks()
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/nbconvertapp.py", line 597, in convert_notebooks
    self.convert_single_notebook(notebook_filename)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/nbconvertapp.py", line 563, in convert_single_notebook
    output, resources = self.export_single_notebook(
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/nbconvertapp.py", line 487, in export_single_notebook
    output, resources = self.exporter.from_filename(
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/exporters/exporter.py", line 201, in from_filename
    return self.from_file(f, resources=resources, **kw)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/exporters/exporter.py", line 220, in from_file
    return self.from_notebook_node(
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/exporters/notebook.py", line 36, in from_notebook_node
    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/exporters/exporter.py", line 154, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/exporters/exporter.py", line 353, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/preprocessors/base.py", line 48, in __call__
    return self.preprocess(nb, resources)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/preprocessors/execute.py", line 102, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbconvert/preprocessors/execute.py", line 123, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib64/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Time and stepsize
T = 900
dt = 1

# Simulation process parameters
simulation_params = {
    "num_simulations": [10**2, 10**3, 10**4, 10**5],
    "num_workers": os.cpu_count(),
    "simulation_batch_size": 50
}

# Density estimator parameters
training_params = {
    "model": 'maf',
    "hidden_features": 70,
    "num_transforms": 15,
    "num_bins": 25,
    "num_rounds": 5
}

# Add nonlinearity to the simulator
c1 = lambda x, y: -x*y-x*y**3
c2 = lambda x, y: -x*y-x*y**3

# Model for data simulation
simulator_model = Swing(f=c1, g=c2, dt=dt, T=T)

# True parameters for the swing equation
true_parameters = {
    'c_1': 0.01,
    'c_2': 0.0001,
    'P_0': 0.001,
    'P_1': 0.00001,
    '\epsilon': 0.001
}

# true parameters
true_parameters_base = torch.tensor(list(true_parameters.values()))
std_deviations_base = torch.tensor([0.001, 0.00001, 0.0001, 0.000001, 0.0001,])

mean_noise_scale = 1.0 
mean_noise_constant = 0 
std_noise_scale = 1.0 
std_noise_constant = 0 

# proposal: Uniform distributions around the true parameter value, negative values are not allowed
proposal = Independent(Uniform(low=0, high=true_parameters_base*10), 1)

# prior: Normal distributions around the true parameter value (with or without noise)
prior = Independent(TruncatedNormal(loc=true_parameters_base*mean_noise_scale + mean_noise_constant, scale=std_deviations_base*std_noise_scale + std_noise_constant, min=0), 1)

# observation with true parameters
observation = simulator_model.simulator(true_parameters_base)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[5], line 50[0m
[1;32m     47[0m proposal [38;5;241m=[39m Independent(Uniform(low[38;5;241m=[39m[38;5;241m0[39m, high[38;5;241m=[39mtrue_parameters_base[38;5;241m*[39m[38;5;241m10[39m), [38;5;241m1[39m)
[1;32m     49[0m [38;5;66;03m# prior: Normal distributions around the true parameter value (with or without noise)[39;00m
[0;32m---> 50[0m prior [38;5;241m=[39m [43mIndependent[49m[43m([49m[43mTruncatedNormal[49m[43m([49m[43mloc[49m[38;5;241;43m=[39;49m[43mtrue_parameters_base[49m[38;5;241;43m*[39;49m[43mmean_noise_scale[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[43mmean_noise_constant[49m[43m,[49m[43m [49m[43mscale[49m[38;5;241;43m=[39;49m[43mstd_deviations_base[49m[38;5;241;43m*[39;49m[43mstd_noise_scale[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[43mstd_noise_constant[49m[43m,[49m[43m [49m[38;5;28;43mmin[39;49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m)[49m[43m,[49m[43m [49m[38;5;241;43m1[39;49m[43m)[49m
[1;32m     52[0m [38;5;66;03m# observation with true parameters[39;00m
[1;32m     53[0m observation [38;5;241m=[39m simulator_model[38;5;241m.[39msimulator(true_parameters_base)

File [0;32m/pfs/data5/home/kit/iai/ik6649/Data-Driven-Bayesian-Parameter-Estimation-with-Neural-Networks/.venv/lib64/python3.9/site-packages/torch/distributions/independent.py:46[0m, in [0;36mIndependent.__init__[0;34m(self, base_distribution, reinterpreted_batch_ndims, validate_args)[0m
[1;32m     42[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m(
[1;32m     43[0m     [38;5;28mself[39m, base_distribution, reinterpreted_batch_ndims, validate_args[38;5;241m=[39m[38;5;28;01mNone[39;00m
[1;32m     44[0m ):
[1;32m     45[0m     [38;5;28;01mif[39;00m reinterpreted_batch_ndims [38;5;241m>[39m [38;5;28mlen[39m(base_distribution[38;5;241m.[39mbatch_shape):
[0;32m---> 46[0m         [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[1;32m     47[0m             [38;5;124m"[39m[38;5;124mExpected reinterpreted_batch_ndims <= len(base_distribution.batch_shape), [39m[38;5;124m"[39m
[1;32m     48[0m             [38;5;124mf[39m[38;5;124m"[39m[38;5;124mactual [39m[38;5;132;01m{[39;00mreinterpreted_batch_ndims[38;5;132;01m}[39;00m[38;5;124m vs [39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(base_distribution[38;5;241m.[39mbatch_shape)[38;5;132;01m}[39;00m[38;5;124m"[39m
[1;32m     49[0m         )
[1;32m     50[0m     shape [38;5;241m=[39m base_distribution[38;5;241m.[39mbatch_shape [38;5;241m+[39m base_distribution[38;5;241m.[39mevent_shape
[1;32m     51[0m     event_dim [38;5;241m=[39m reinterpreted_batch_ndims [38;5;241m+[39m [38;5;28mlen[39m(base_distribution[38;5;241m.[39mevent_shape)

[0;31mValueError[0m: Expected reinterpreted_batch_ndims <= len(base_distribution.batch_shape), actual 1 vs 0


============================= JOB FEEDBACK =============================

NodeName=uc2n519
Job ID: 23252614
Cluster: uc2
User/Group: ik6649/iai
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 40
CPU Utilized: 00:00:07
CPU Efficiency: 0.41% of 00:28:40 core-walltime
Job Wall-clock time: 00:00:43
Memory Utilized: 73.57 MB
Memory Efficiency: 0.18% of 39.06 GB
